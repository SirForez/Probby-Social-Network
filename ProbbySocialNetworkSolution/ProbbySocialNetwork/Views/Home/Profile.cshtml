@model ProbbySocialNetwork.Models.ViewModels.ProfileViewModel

@{
    ViewBag.Title = "Profile";
}


<script>

    var main = function () {

        $('.imageUrl').hide();

        $('#uploadImage').click(function () {


            $('.imageUrl').toggle();

            $('#uploadImage').hide();
        });




    }

    $(document).ready(main);





</script>

<div class="container" class="nw">
    <div class="lhsNav">
        @if (Model.currentUser.ProfilePic == null)
        {
            <img src="~/Content/Images/dabs.jpg" class="profilePic">
        }
        else
        {
            <img src="@Model.currentUserProfile.ProfilePic" class="profilePic">
        }
        @using (Html.BeginForm("EditProfilePic", "Home", FormMethod.Post, new { id = "profilePictureForm" }))
        {
            <div class="form-horizontal">
                <label class="sr-only" for="picLink">New Picture</label>
                <textarea class="form-control" rows="1" id="newProfilePic" name="picLink"></textarea>
                <button type="submit" class="btn btn-primary">Submit</button>
            </div>
            @Html.ValidationSummary(false)
        }
        <p>@Model.currentUserProfile.UserName's Profile</p>
        @if (Model.currentUserProfile.UserName != User.Identity.Name)
        {
            if (Model.currentUserFollowing.Contains(Model.currentUserProfile))
            {
                @Html.ActionLink("Unfollow", "RemoveFollowing", "Account", new { username = Model.currentUserProfile.UserName }, null)
            }
            else
            {
                @Html.ActionLink("Follow", "AddFollowing", "Account", new { username = Model.currentUserProfile.UserName }, null)
            }
        }
    </div>
    <div class="theContent">
        <!--Status-->
        <div class="status">
            <h4>Create Status</h4>
            @using (Html.BeginForm("CreateStatus", "Status", FormMethod.Post, new { id = "statusForm" }))
            {
                <input type="hidden" name="UserID" value="@Model.currentUser.Id" />
                <input type="hidden" name="groupID" value="" />
                <input type="hidden" name="PostedToID" value="@Model.currentUserProfile.Id" />
                <div class="form-horizontal">
                    <label class="sr-only" for="statusText">Status</label>
                    <textarea class="form-control" rows="4" id="statusText" name="statusText"></textarea>
                    <input type="button" id="uploadImage" value="Upload image" />
                    <div class="imageUrl">
                        <label for="url">Enter URL:</label>
                        <input type="text" name="url" size="35" maxlength="255" />
                        <input type="submit" name="submit" value="Submit" />
                    </div>
                    <button type="submit" class="btn btn-primary">Post</button>
                </div>
                @Html.ValidationSummary(false)
            }

        </div>
        @using ProbbySocialNetwork.Models
        @foreach (Status s in Model.currentUserStatusHistory)
        {
            <div id="status">
                <h3>
                    @if (s.Post == null)
                    {
                        <img src="@s.MediaURL" alt="image" />
                    }
                    else
                    {
                        @s.Post
                    }
                </h3>
                <p>
                    @s.UserName | @s.Date |
                    @if (Model.currentUser.Id == s.UserID)
                    {
                        @Html.ActionLink("Remove", "RemoveStatus", "Status", new { id = s.ID }, null)
                    }
                </p>
                <div id="status-comment">
                    @foreach (Comment c in Model.commentsForStatuses)
                    {
                        if (c.StatusID == s.ID)
                        {
                            <div id="status-comment-body" class="comment">
                                <p>@c.UserName: @c.Body | @c.DateInserted |

                                    @if (Model.currentUser.Id == s.UserID)
                                    {
                                        @Html.ActionLink("Remove", "RemoveComment", "Status", new { id = c.ID }, null)
                                    }
                                </p>
                            </div>
                        }
                    }
                </div>
                <div>
                    @using (Html.BeginForm("CreateComment", "Status", FormMethod.Post, new { id = "commentForm" }))
                    {
                        <input type="hidden" name="statusID" value="@s.ID" />
                        <div class="form-horizontal">
                            <label class="sr-only" for="commentText">Status</label>
                            <input type="text" class="form-control" rows="2" id="commentText" name="commentText"></input>
                        </div>

                        <input type="hidden" name="returnUrl" value="" />
                        @Html.ValidationSummary(false)
                    }
                </div>           
            </div>
        }
    </div>
</div>

